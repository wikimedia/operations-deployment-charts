---
docker:
  registry: docker-registry.discovery.wmnet
mesh:
  image_version: 1.23.10-3
  telemetry:
    enabled: true
  certmanager:
    enabled: true
    domains:
    - discovery.wmnet
    - svc.eqiad.wmnet
    extraFQDNs:
    - ml-staging.svc.eqiad.wmnet
    - ml-staging.svc.eqiad.wmnet
monitoring:
  image_version: 0.0.10
common_images:
  httpd:
    exporter: prometheus-apache-exporter:0.0.4-20240623
  mcrouter:
    mcrouter: mcrouter:2023.07.17.00-1-20240714
    exporter: prometheus-mcrouter-exporter:0.0.1-3-20240714
  nutcracker:
    nutcracker: nutcracker:0.0.5-20240825
    exporter: prometheus-nutcracker-exporter:0.0.2-20211010
  rsyslogd: rsyslog:8.2102.0-3
  statsd:
    exporter: prometheus-statsd-exporter:0.26.1-2-20250622
  postgresql:
    '15': 2025-08-06-145838-e8a1b6ac1f969432aa274426a7db1baf8b02cb21@sha256:29254e052217729cbd96562e8d35827739ca6375a047653e1e206539d570fd87
services_proxy:
  mathoid:
    port: 6003
    timeout: 3s
    upstream: &1
      ips:
      - 127.0.0.1/32
      - 169.254.0.1/32
      address: mock.discovery.wmnet
      port: 443
      encryption: true
  eventgate-analytics:
    port: 6004
    timeout: 10s
    upstream: *1
  eventgate-main:
    port: 6005
    timeout: 61s
    upstream: *1
  sessionstore:
    port: 6006
    timeout: 2.5s
    upstream: *1
  echostore:
    port: 6007
    timeout: 2.5s
    upstream: *1
  termbox:
    port: 6008
    timeout: 25s
    upstream: *1
  restbase:
    port: 6011
    upstream: *1
    timeout: 30s
    xfp: https
  push-notifications:
    port: 6012
    timeout: 2.5s
    upstream: *1
  mobileapps:
    port: 6012
    timeout: 120s
    upstream: *1
  eventgate-analytics-external:
    port: 6013
    timeout: 5s
    upstream: *1
  proton:
    port: 6013
    timeout: 120s
    upstream: *1
  citoid:
    port: 6014
    timeout: 120s
    upstream: *1
  cxserver:
    port: 6015
    timeout: 120s
    upstream: *1
  recommendation:
    port: 6016
    timeout: 120s
    upstream: *1
  wikifeeds:
    port: 6017
    timeout: 120s
    upstream: *1
  zotero:
    port: 6018
    timeout: 120s
    upstream: *1
  apertium:
    port: 6019
    timeout: 120s
    upstream: *1
  thanos-query:
    port: 6021
    timeout: 120s
    upstream: *1
  thanos-swift:
    port: 6022
    timeout: 120s
    upstream: *1
  schema:
    port: 6023
    timeout: 120s
    upstream: *1
  shellbox:
    port: 6024
    timeout: 60s
    upstream: *1
  shellbox-constraints:
    port: 6025
    timeout: 10s
    upstream: *1
  shellbox-media:
    port: 6026
    timeout: 60s
    upstream: *1
  shellbox-syntaxhighlight:
    port: 6027
    timeout: 60s
    upstream: *1
  shellbox-timeline:
    port: 6028
    timeout: 60s
    upstream: *1
  linkrecommendation:
    port: 6029
    timeout: 10s
    upstream: *1
  image-suggestion:
    port: 6030
    timeout: 10s
    upstream: *1
  inference:
    port: 6031
    timeout: 60s
    upstream: *1
  device-analytics:
    port: 6032
    timeout: 10s
    upstream: *1
  rest-gateway:
    port: 6033
    timeout: 10s
    upstream: *1
  wikifunctions:
    port: 6034
    timeout: 15.5s
    upstream: *1
  ipoid:
    port: 6035
    timeout: 5s
    upstream: *1
  shellbox-video:
    port: 6036
    timeout: 86400s
    upstream: *1
  mpic:
    port: 6037
    timeout: 30s
    upstream: *1
  data-gateway:
    port: 6038
    timeout: 10s
    upstream: *1
  chart-renderer:
    port: 6039
    timeout: 30s
    upstream: *1
  tegola-vector-tiles:
    port: 6040
    timeout: 10s
    upstream: *1
  wdqs-internal-main:
    port: 6041
    timeout: 10s
    upstream: *1
  wdqs-internal-scholarly:
    port: 6042
    timeout: 10s
    upstream: *1
  swift-eqiad:
    port: 6101
    timeout: 50s
    upstream: *1
  swift-codfw:
    port: 6201
    timeout: 50s
    upstream: *1
  search-chi-eqiad:
    port: 6102
    timeout: 50s
    upstream: *1
  search-chi-codfw:
    port: 6202
    timeout: 50s
    upstream: *1
  search-chi:
    port: 6302
    timeout: 50s
    upstream: *1
  search-omega-eqiad:
    port: 6103
    timeout: 50s
    upstream: *1
  search-omega-codfw:
    port: 6203
    timeout: 50s
    upstream: *1
  search-omega:
    port: 6303
    timeout: 50s
    upstream: *1
  search-psi-eqiad:
    port: 6104
    timeout: 50s
    upstream: *1
  search-psi-codfw:
    port: 6204
    timeout: 50s
    upstream: *1
  search-psi:
    port: 6304
    timeout: 50s
    upstream: *1
  cloudelastic-chi-eqiad:
    port: 6105
    timeout: 50s
    upstream: *1
  cloudelastic-omega-eqiad:
    port: 6106
    timeout: 50s
    upstream: *1
  cloudelastic-psi-eqiad:
    port: 6107
    timeout: 50s
    upstream: *1
  inference-staging:
    port: 6205
    timeout: 60s
    upstream: *1
  analytics-web:
    port: 6206
    timeout: 60s
    upstream: *1
    http_host: analytics.wikimedia.org
  mwapi-async:
    port: 6500
    upstream: *1
    timeout: 120s
    xfp: https
  mwapi:
    port: 6501
    upstream: *1
    timeout: 60s
    xfp: https
  mw-api-int-async:
    port: 6500
    upstream: *1
    timeout: 120s
    xfp: https
  mw-api-int:
    port: 6501
    upstream: *1
    timeout: 60s
    xfp: https
  mw-api-int-async-ro:
    port: 6500
    upstream: *1
    timeout: 120s
    xfp: https
  mw-parsoid:
    port: 6505
    timeout: 30s
    xfp: https
    upstream: *1
  restbase-for-services:
    port: 6503
    timeout: 122s
    upstream: *1
    xfp: https
  machinetranslation:
    port: 6504
    timeout: 120s
    upstream: *1
  mw-wikifunctions-ro:
    port: 6501
    upstream: *1
    timeout: 60s
    xfp: https
  mw-jobrunner:
    port: 6506
    timeout: 30s
    xfp: https
    upstream: *1
  mw-misc:
    port: 6508
    timeout: 30s
    upstream: *1
  noc:
    port: 6509
    timeout: 30s
    http_host: noc.wikimedia.org
    upstream: *1
  data-gateway-staging:
    port: 6510
    timeout: 10s
    upstream: *1
mariadb:
  section_ports:
    s1: 3311
    s2: 3312
    s3: 3313
    s4: 3314
    s5: 3315
    s6: 3316
    s7: 3317
    s8: 3318
    x1: 3320
    x3: 3363
    m1: 3321
    m2: 3322
    m3: 3323
    m5: 3325
    staging: 3350
    matomo: 3351
    analytics_meta: 3352
    backup1-eqiad: 3360
    backup1-codfw: 3361
zookeeper_clusters:
  main-eqiad: &2
  - 185.71.138.138/32
  main-codfw: *2
  flink-eqiad: *2
  flink-codfw: *2
  druid-analytics-eqiad: *2
  druid-public-eqiad: *2
  druid-analytics-test-eqiad: *2
  analytics-eqiad: *2
  test-eqiad: *2
  zuul-eqiad: *2
  zuul-codfw: *2
kafka_brokers:
  main-eqiad: &3
  - 185.71.138.138/32
  main-codfw: *3
  jumbo-eqiad: *3
  logging-eqiad: *3
  logging-codfw: *3
  test-eqiad: *3
external_services_definitions:
  kafka:
    _meta:
      ports:
      - name: plaintext
        port: 9092
      - name: tls
        port: 9093
    instances:
      main-eqiad:
      - 185.71.138.138/32
      - 2001:67c:930::1/128
      main-codfw:
      - 185.71.138.138/32
      - 2001:67c:930::1/128
  kerberos:
    _meta:
      ports:
      - name: ticket
        port: 88
        protocol: UDP
      - name: ticket-large
        port: 88
    instances:
      kdc:
      - 185.71.138.138
      - 2001:67c:930::1
kubernetesVersion: '1.23'
